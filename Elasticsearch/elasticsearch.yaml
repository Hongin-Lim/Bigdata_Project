apiVersion: apps/v1
kind: Deployment
metadata:
  name: elastic-app
  namespace: default
spec:
  selector:
    matchLabels:
      app: elastic-app
  replicas: 1
  template:
    metadata:
      labels:
        app: elastic-app
    spec:
      containers:
      - name: elastic
        image: cycloid87/jj-elasticsearch:2.0    # 재중님 이미지로 엘라스틱서치 설치
        imagePullPolicy: IfNotPresent
        ports:
        - containerPort: 9200
          protocol: TCP
        command: [ "sleep" ]
        args: [ "infinity" ]



kubectl apply -f elasticsearch.yaml  # yaml 파일 적용 명령어

kubectl expose deploy elastic --type LoadBalancer --name elastic  # elastic deployment에 service 부여

kubectl exec -it [디플로이먼트 이름] /bin/bash  # 컨테이너 접속 명령어

sudo sysctl -w vm.max_map_count=262144 # 컨테이너가 할당된 노드에서 사용하는 명령어

service elasticsearch start  # elasticsearch 실행 명령어

